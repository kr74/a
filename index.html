<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>지역봉사지도원 활동일지</title>

  <meta property="og:title" content="지역봉사지도원 활동일지 작성하기" />
  <meta property="og:description" content="오늘 활동일지를 간편하게 작성해 주세요." />
  <meta property="og:image" content="https://dagajala-star.github.io/activity-landing/info.png" />
  <meta property="og:url" content="https://kr74.github.io/a/" />
  <meta property="og:type" content="website" />

  <link rel="preconnect" href="https://script.google.com" crossorigin>
  <link rel="dns-prefetch" href="//script.google.com">
  <link rel="preconnect" href="https://script.googleusercontent.com" crossorigin>
  <link rel="dns-prefetch" href="//script.googleusercontent.com">

  <style>
    body { margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",Arial,sans-serif; background:#fff; color:#111; }
    .wrap { min-height:100vh; display:grid; place-items:center; padding:28px; text-align:center; }
    .title { font-size:24px; font-weight:900; line-height:1.3; letter-spacing:-0.2px; }
    .sub { margin-top:10px; font-size:16px; font-weight:700; opacity:0.78; line-height:1.45; }
    .dots { display:inline-block; width:1.6em; text-align:left; }
    .dots::after { content:""; display:inline-block; width:1.6em; animation:dots 1.1s infinite steps(4,end); }
    @keyframes dots { 0%{content:"";}25%{content:".";}50%{content:"..";}75%{content:"...";}100%{content:"";} }
  </style>
</head>

<body>
  <div class="wrap">
    <div>
      <div class="title">활동일지로 이동 중입니다<span class="dots"></span></div>
      <div class="sub">잠시만 기다려 주세요. 곧 자동으로 연결됩니다.</div>
    </div>
  </div>

  <script>
    (function () {
      const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbwRFx-3vd65PAxY2AtJJ6Tb35jI239DZyQj8YD2xIMxQwMZJOc2lJKaHZ9PKYSGSu9U/exec";

      // ✅ kr74(푸시 클릭 URL)에서 저장/복구할 키
      const K_STORE_KEY = "CENTER_CODE";
      const NAME_STORE_KEY = "USER_NAME";

      // 1) 쿼리 + 해시 파라미터 합치기
      const qs = new URLSearchParams(window.location.search);
      if (window.location.hash) {
        const hs = new URLSearchParams(window.location.hash.replace(/^#/, ""));
        for (const [k, v] of hs.entries()) {
          if (!qs.has(k)) qs.set(k, v);
        }
      }

      // 2) k 저장/복구
      const incomingK = (qs.get("k") || "").trim();
      if (incomingK) {
        localStorage.setItem(K_STORE_KEY, incomingK);
      } else {
        const savedK = (localStorage.getItem(K_STORE_KEY) || "").trim();
        if (savedK) qs.set("k", savedK);
      }

      // 3) name 저장/복구
      const incomingName = (qs.get("name") || "").trim();
      if (incomingName) {
        localStorage.setItem(NAME_STORE_KEY, incomingName);
      } else {
        const savedName = (localStorage.getItem(NAME_STORE_KEY) || "").trim();
        if (savedName) qs.set("name", savedName);
      }

      // 4) 구글 웹앱으로 전달
      const paramStr = qs.toString();
      const joiner = WEBAPP_URL.includes("?") ? "&" : "?";
      const target = paramStr ? (WEBAPP_URL + joiner + paramStr) : WEBAPP_URL;

      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          window.location.replace(target);
        });
      });
    })();
  </script>

  <noscript>
    <div class="wrap">
      <div>
        <div class="title">자바스크립트가 꺼져 있어요.</div>
        <div class="sub">브라우저 설정에서 자바스크립트를 켜주세요.</div>
      </div>
    </div>
  </noscript>
</body>
</html>
